<!--주소api-->
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
   window.onload = function () {
      document.getElementById("address_kakao").addEventListener("click", function () {
         new daum.Postcode({
            oncomplete: function (data) {
               // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분입니다.
               // 예제를 참고하여 다양한 활용법을 확인해 보세요.
               document.getElementById("address_kakao").value = data.address; // 주소 넣기
               document.querySelector("input[id=address_detail]").focus(); //상세입력 포커싱
            }
         }).open();
      });
   }
</script>
<style>
   .phone {
      width: 90px;
   }
</style>
<main class="main">
   <!-- Breadcrumb-->
   <ol class="breadcrumb">
      <li class="breadcrumb-item">Home</li>
      <li class="breadcrumb-item">
         <a style="font-weight: bold;">회원관리</a>
      </li>
      <li class="breadcrumb-item active">회원정보</li>
      <!-- Breadcrumb Menu-->
   </ol>

   <div class="container-fluid">
      <div class="animated fadeIn">
         <div class="row">
            <div class="col-lg-6">
               <div class="card">
                  <div class="card-header">
                     <i class="fa fa-align-justify"></i> 회원 등록</div>
                  <form action="" id="userEnrollForm" method="post" enctype="multipart/form-data">

                     <div class="card-body">
                        <!-- 컨텐츠 -->
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">프로필사진</label>
                           <div style="display: flex; flex-direction: column; gap: 25px; padding-left: 15px">
                              <input type="file" id="userProfile" name="file" />
                           </div>
                           <input type="hidden" id="userImgyn" name="userImgyn" />
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">* 회원명 *</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userName" type="text" name="userName" value=""
                                 maxlength="10">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">* 휴대번호 *</label>
                           <div class="col-md-9 phone_num">
                              <input class="form-control phone" id="userPhone1" type="number" name="userPhone1"
                                 value="">&nbsp;&nbsp;-&nbsp;&nbsp;
                              <input class="form-control phone" id="userPhone2" type="number" name="userPhone2"
                                 value="">&nbsp;&nbsp;-&nbsp;&nbsp;
                              <input class="form-control phone" id="userPhone3" type="number" name="userPhone3"
                                 value="">
                           </div>
                        </div>

                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">이메일</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userEmail" type="text" name="userEmail" value=""
                                 maxlength="50">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">팩스번호</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userFax" type="number" name="userFax" value=""
                                 maxlength="10">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">병원명</label>
                           <div class="col-md-9">
                              <input class="form-control" id="hosName" type="text" name="hosName" value=""
                                 maxlength="20">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">우편번호</label>
                           <div class="col-md-9">
                              <input class="form-control" id="hosPost" type="number" name="hosPost" value=""
                                 maxlength="10">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">병원주소</label>
                           <div class="col-md-9">
                              <input class="form-control" type="text" id="address_kakao" name="userAdres" value="" />
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">상세주소</label>
                           <div class="col-md-9">
                              <input class="form-control" type="text" id="address_detail" name="userAdres4" value=""
                                 placeholder="상세주소를 입력해주세요" maxlength="100" />
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">병원번호</label>
                           <div class="col-md-9 phone_num">
                              <input class="form-control phone" id="hosPhone1" type="number" name="hosPhone1"
                                 value="">&nbsp;&nbsp;-&nbsp;&nbsp;
                              <input class="form-control phone" id="hosPhone2" type="number" name="hosPhone2"
                                 value="">&nbsp;&nbsp;-&nbsp;&nbsp;
                              <input class="form-control phone" id="hosPhone3" type="number" name="hosPhone3" value="">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">홈페이지</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userUrl" type="text" name="userUrl" value=""
                                 maxlength="300">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">형태</label>
                           <div class="col-md-9">
                              <select class="dropdown" name="userType">
                                 <% for(i = 0; i < userType.length; i++) { %>
                                 <option <%if(userType[i].userType=='형태'){%> value="" <%}else{%>
                                    value="<%= userType[i].userType %>" <%}%>><%= userType[i].userType %></option>
                                    <% } %> </select> </div> </div> <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">역할</label>
                                    <div class="col-md-9">
                                       <select class="dropdown" name="userPosition">
                                          <% for(i = 0; i < userPosition.length; i++) { %>
                                          <option <%if(userPosition[i].userPosition=='전체'){%> value="" <%}else{%>
                                             value="<%= userPosition[i].userPosition %>"
                                             <%}%>><%= userPosition[i].userPosition %></option> <% } %> </select> </div>
                                             </div> <!-- <div class="form-group row">
                                             <label class="col-md-2 col-form-label" for="text-input">푸쉬알림</label>
                                             <div class="col-md-9">
                                                <select class="dropdown" name="pushYn">
                                                   <option value="0">동의</option>
                                                   <option value="1">비동의</option>
                                                </select>
                                             </div>
                                    </div> -->
                                    <div class="form-group row">
                                       <label class="col-md-2 col-form-label" for="text-input">병원세부설명</label>
                                       <div class="col-md-9">
                                          <textarea id="content1" style="width: 100%; height: 150px"
                                             maxlength="300"></textarea>
                                          <input class="form-control" id="hosDetail" type="hidden" name="hosDetail"
                                             value="">
                                       </div>
                                    </div>
                                    <div class="form-group row">
                                       <label class="col-md-2 col-form-label" for="text-input">진료시간</label>
                                       <div class="col-md-9">
                                          <textarea id="content2" style="width: 100%; height: 150px"
                                             maxlength="300"></textarea>
                                          <input class="form-control" id="hosMedicalInfo" type="hidden"
                                             name="hosMedicalInfo" value="">
                                       </div>
                                    </div>
                                    <div class="form-group row">
                                       <label class="col-md-2 col-form-label">병원사진</label>
                                       <div
                                          style="display: flex; flex-direction: column; gap: 25px; padding-left: 15px">
                                          <input type="file" id="file" name="file">
                                          <input type="file" id="file" name="file" />
                                          <input type="file" id="file" name="file" />
                                          <input type="file" id="file" name="file" />
                                          <input type="file" id="file" name="file" />
                                          <input type="file" id="file" name="file" />
                                       </div>
                                    </div>

                                    <% if(sessionAdminId == 'resoft') { %>
                                    <div class="form-group row">
                                       <label class="col-md-2 col-form-label" for="text-input">개발자</label>
                                       <div class="col-md-9">
                                          <input type="checkbox" style='zoom:2.0;' name="adminyn" value="admin" checked>
                                       </div>
                                    </div>
                                    <% } %>
                                    <!--option 버튼  -->
                                    <div class="option_button">
                                       <div>
                                          <button class="btn btn-block btn-outline-success" type="button"
                                             id="update_btn">등록</button>
                                       </div>
                                       <div>
                                          <button class="btn btn-block btn-outline-danger" type="button"
                                             onclick="history.go(-1)" style="margin-bottom: 10px;">취소</button>
                                       </div>
                                    </div>
                           </div>
                  </form>
               </div>
            </div>
         </div>
      </div>
   </div>
</main>

<script type="text/javascript">
   $(document).ready(function () {
      //확장자 체크
      $("input:file[name='file']").change(function () {
         var str = $(this).val();
         var fileName = str.split('\\').pop().toLowerCase();
         // alert(fileName);
         checkFileName(fileName);
      });


   });
   //확장자 체크
   function checkFileName(str) {
      var ext = str.split('.').pop().toLowerCase();
      // alert(ext);
      if ($.inArray(ext, ['jpg', 'png', 'jpeg', 'gif']) == -1) {
         alert(ext + '파일은 업로드 하실 수 없습니다.');
         $("input:file[name='file']").val("");
      }
   }

   $("#update_btn").click(function () {
      var userName = $("#userName").val();
      var userPhone1 = $("#userPhone1").val();
      var userPhone2 = $("#userPhone2").val();
      var userPhone3 = $("#userPhone3").val();
      var userProfile = $("#userProfile").val();
      var content1 = $("#content1").val();
      var content2 = $("#content2").val();
      var [phoneContent1, phoneContent2, phoneContent3, phoneContent4, phoneContent5, phoneContent6] = [$('#userPhone1').val(), $('#userPhone2')
         .val(), $('#userPhone3').val(), $('#hosPhone1').val(), $('#hosPhone2').val(), $('#hosPhone3').val()
      ];

      switch (true) {
         case userName == '':
            alert("회원명을 입력해주세요.");
            $("#userName").focus();
            return false;

         case userPhone1 == '':
            alert("올바른 휴대번호를 입력해주세요.");
            $("#userPhone1").focus();
            return false;

         case userPhone2 == '':
            alert("올바른 휴대번호를 입력해주세요.");
            $("#userPhone2").focus();
            return false;

         case userPhone3 == '':
            alert("올바른 휴대번호를 입력해주세요.");
            $("#userPhone3").focus();
            return false;

         case phoneContent1.length < 2 || phoneContent1.length > 3:
            alert("올바른 휴대번호를 입력해주세요.")
            $("#userPhone1").focus();
            return false;

         case phoneContent2.length < 3 || phoneContent2.length > 4:
            alert("올바른 휴대번호를 입력해주세요.");
            $("#userPhone2").focus();
            return false;

         case phoneContent3.length < 3 || phoneContent3.length > 4:
            alert("올바른 휴대번호를 입력해주세요.")
            $("#userPhone3").focus();
            return false;

         case phoneContent4 != '' && (phoneContent4.length < 2 || phoneContent4.length > 3):
            alert("올바른 병원번호를 입력해주세요.")
            $("#hosPhone1").focus();
            return false;

         case phoneContent5 != '' && (phoneContent5.length < 3 || phoneContent5.length > 4):
            $("#hosPhone2").focus();
            alert("올바른 병원번호를 입력해주세요.")
            return false;

         case phoneContent6 != '' && (phoneContent6.length < 3 || phoneContent6.length > 4):
            $("#hosPhone3").focus();
            alert("올바른 병원번호를 입력해주세요.")
            return false;
      }

      if (confirm("등록하시겠습니까?") == true) {
         if (userProfile == '') {
            $("#userImgyn").val("0");
         }
         $("#hosDetail").attr("value", content1);
         $("#hosMedicalInfo").attr("value", content2);
         $("#userEnrollForm").attr("action", "userInsert");
         $("#userEnrollForm").submit();
      } else {
         return;
      }
   });
</script>