<style>
   .phone {
      width: 90px;
   }
</style>
<main class="main">
   <!-- Breadcrumb-->
   <ol class="breadcrumb">
      <li class="breadcrumb-item">Home</li>
      <li class="breadcrumb-item">
         <a style="font-weight: bold;">회원관리</a>
      </li>
      <li class="breadcrumb-item active">회원정보</li>
      <!-- Breadcrumb Menu-->
   </ol>

   <div class="container-fluid">
      <div class="animated fadeIn">
         <div class="row">
            <div class="col-lg-6">
               <div class="card">
                  <div class="card-header">
                     <i class="fa fa-align-justify"></i> 회원정보 수정</div>
                  <div class="card-body">
                     <!-- 컨텐츠 -->
                     <form action="" id="userForm" method="" enctype="multipart/form-data">
                        <input type="hidden" name="page" value="<%=page%>">
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">회원번호</label>
                           <div class="col-md-9">
                              <input class="form-control" id="uid" type="text" name="uid" value="<%=result.uid%>"
                                 readonly>
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">프로필사진</label>
                           <div class="col-md-9">
                              <% if(userImg != null && userImg != '') {%>
                              <img src="../../../<%= userImg %>" alt="사진" width="40%" />
                              <button id="searchAction" class="btn btn-block btn-outline-danger" type="button"
                                 onclick="javascript:file_del();">삭제</button>
                              <input type="hidden" id="userImg" name="userImg" value="<%=userImg%>">
                              </td>
                              <% }else{ %>
                              <input type="file" id="file" name="file" />
                              <% } %>
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">회원명</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userName" type="text" name="userName"
                                 value="<%=result.userName%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">병원명</label>
                           <div class="col-md-9">
                              <input class="form-control" id="hosName" type="text" name="hosName"
                                 value="<%=result.hosName%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">우편번호</label>
                           <div class="col-md-9">
                              <input class="form-control" id="hosPost" type="text" name="hosPost"
                                 value="<%=result.hosPost%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">병원주소</label>
                           <div class="col-md-9">
                              <input class="form-control" id="ucmtitle" type="text" name="ucmtitle"
                                 value="<%=result.userAdres1%> <%=result.userAdres2%> <%=result.userAdres3%>">
                              <input type="hidden" id="userAdres1" name="userAdres1" value="<%=result.userAdres1%>">
                              <input type="hidden" id="userAdres2" name="userAdres2" value="<%=result.userAdres2%>">
                              <input type="hidden" id="userAdres3" name="userAdres3" value="<%=result.userAdres3%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">병원번호</label>
                           <div class="col-md-9" style="display: flex;text-align: center;align-items: center;">
                              <input class="form-control phone" id="hosPhone1" type="text" name="hosPhone1"
                                 value="<%=result.hosPhone1%>">&nbsp;&nbsp;-&nbsp;&nbsp;
                              <input class="form-control phone" id="hosPhone2" type="text" name="hosPhone2"
                                 value="<%=result.hosPhone2%>">&nbsp;&nbsp;-&nbsp;&nbsp;
                              <input class="form-control phone" id="hosPhone3" type="text" name="hosPhone3"
                                 value="<%=result.hosPhone3%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">형태</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userType" type="text" name="userType"
                                 value="<%=result.userType%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">역할</label>
                           <div class="col-md-9">
                              <input class="form-control" id="userPosition" type="text" name="userPosition"
                                 value="<%=result.userPosition%>">
                           </div>
                        </div>
                        <div class="form-group row">
                           <label class="col-md-2 col-form-label" for="text-input">푸쉬알림</label>
                           <div class="col-md-9">
                              <select class="dropdown" name="pushYn">
                                 <option value="0" <%if(result.pushYn=="0"){%> selected="selected" <%}%>>동의</option>
                                 <option value="1" <%if(result.pushYn=="1"){%> selected="selected" <%}%>>비동의</option>
                             </select>
                           </div>
                        </div> 
                     </form>
                     <!--option 버튼  -->
                     <div class="option_button">
                        <div>
                           <button class="btn btn-block btn-outline-success" type="button" id="update_btn" onclick="userUpdate()">수정</button>
                        </div>
                        <div>
                           <button class="btn btn-block btn-outline-danger" type="button"
                              onclick="location.href='/admin/m_user/selectOne?uid=<%=result.uid%>&page=<%=page%>'">
                                    취소</button>
                           </div>
                        </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</main>

<script type="text/javascript">
   $(document).ready(function () {
      //확장자 체크
      $("input:file[name='file']").change(function () {
         var str = $(this).val();
         var fileName = str.split('\\').pop().toLowerCase();
         // alert(fileName);
         checkFileName(fileName);
      });
   });
   //확장자 체크
   function checkFileName(str) {
      var ext = str.split('.').pop().toLowerCase();
      // alert(ext);
      if ($.inArray(ext, ['jpg', 'png', 'jpeg', 'gif']) == -1) {
         alert(ext + '파일은 업로드 하실 수 없습니다.');
         $("input:file[name='file']").val("");
      }
   }
   //수정
   function userUpdate() {
      if (confirm("수정하시겠습니까?")) {
         $("#userForm").attr("action", "userUpdate");
         $("#userForm").attr("method", "post");
         $("#userForm").submit();
         alert("수정이 완료되었습니다.");
      }
   }

   //첨부파일 삭제
   function file_del() {
      if (confirm("실제 파일이 삭제됩니다 \n정말 삭제하시겠습니까?")) {
         $("#userForm").attr("action", "imgDelete");
         $("#userForm").attr("method", "get");
         $("#userForm").submit();
      }
   }
</script>