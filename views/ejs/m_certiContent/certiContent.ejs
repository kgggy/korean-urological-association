<style>
    .image-box {
        height: 280px;
        overflow: hidden;
        margin: 0 auto;
    }

    .image-thumbnail {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .certiContentEach {
        width: calc(100% / 4);
        text-align: center;
    }

    .certiContentAll {
        display: flex;
        flex-wrap: wrap;
        padding: 0 !important;
        list-style: none;
    }

    #firstForm {
        display: flex;
        justify-content: end;
        gap: 5px;
    }
</style>
<main class="main">
    <!-- Breadcrumb-->
    <ol class="breadcrumb">
        <li class="breadcrumb-item">Home</li>
        <li class="breadcrumb-item">
            <% if(param == 0) { %>
            <a style="font-weight: bold;">탄소실천관리</a>
            <% } else {%>
            <a style="font-weight: bold;">챌린지관리</a>
            <% } %>
        <li class="breadcrumb-item active">글관리</li>
    </ol>
    <div class="container-fluid">
        <div class="animated fadeIn">
            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header">
                            <%if(param == 0){%>
                            <i class="fa fa-align-justify"></i> 탄소실천 글 관리
                            <% } else {%>
                            <i class="fa fa-align-justify"></i> 챌린지 글 관리
                            <% } %>
                        </div>
                        <div class="card-body">
                            <form id="certiContForm" name="certiContForm" method="" action="">
                                <input type="hidden" name="page" value="1">
                                <input type="hidden" name="certiDivision" value="<%= param %>">
                                <input type="hidden" name="certiContentId" value="">
                                <input type="hidden" name="uid" value="81">
                                <div align="right">
                                    <select class="dropdown" name="searchType">
                                        <option value="0" selected="selected">--전체--</option>
                                        <option value="certiTitleId" <%if(searchType=="certiTitleId"){%> selected="selected" <%}%>>테마</option>
                                        <option value="userNick" <%if(searchType=="userNick"){%> selected="selected" <%}%>>닉네임</option>
                                    </select>
                                    <input class="searchbox" type="text" name="searchText" value="<%=searchText%>" />
                                    <button class="btn btn-block btn-outline-success" type="submit" id="searchAction">검색</button>
                                </div>
                                <div class="certiContentAll-wrap">
                                    <ul class="certiContentAll">
                                        <% if(results.length > 0) { %>
                                        <% for(var i = (page * page_num) - page_num; i < (page * page_num); i++) { 
                                        if(i > length){
                                            i++;
                                        } else { %>
                                        <li class="certiContentEach">
                                            <% if(results.length > 0 && results[i].fileRoute != null && results[i].fileRoute != ''){ %>
                                            <div class="image-box"><img class="image-thumbnail"
                                                    src="../../../<%= results[i].fileRoute %>"
                                                    style="width:100%; padding:15px !important;" alt="">
                                            </div>
                                            <% } else {%>
                                            <div class="image-box"><img class="image-thumbnail"
                                                    src="../../../public/images/certification/sprout.png"
                                                    style="padding:15px !important;" alt="">
                                            </div> 
                                            <% } %>
                                            <div class="detailBtn" style="margin-top: 15px;">
                                                <button id="enrollAction" type="button"
                                                    class="btn btn-block btn-outline-success"
                                                    onclick="selectOne('<%= results[i].certiContentId %>')"
                                                    style="width:90px">상세보기</button>
                                                <button id="enrollAction" type="button"
                                                    class="btn btn-block btn-outline-success" onclick="comment('/admin/m_certiContent/certiComment', '', 'width=640, height=700, scrollbars=1', '<%= results[i].certiContentId %>',
                '<%= param %>')">댓글</button>
                                            </div>
                                        </li>
                                        <% } %>
                                        <% } %>
                                        <% } else {%>
                                        <p>조회된 글이 없습니다.</p>
                                        <% }%>
                                    </ul>
                                </div>
                                <p class="float_r">
                                    <!-- 나중에 boardId랑 uid(admin) 관리자걸로 고쳐줘야함!!!!!!!!!!!!!!!!!!!!-->
                                    <input id="enrollAction" type="button" class="btn btn-block btn-outline-success"
                                        onclick="enroll()" value="등록" />
                                </p>
                                <div class="mt_20">
                                    <div class="paging" id="page_navi">
                                        <ul class="pagination customPaging">
                                            <li><a href="/admin/m_certiContent/certicontentAll?certiDivision=<%= param %>&page=1"
                                                    class="num">
                                                    << </a> 
                                            </li> 
                                            <li><a <%if((page<last-1)||(page==1)){%><%} else {%>
                                                    href="/admin/m_certiContent/certicontentAll?certiDivision=<%= param %>&page=<%= parseInt(page) - 1 %>"
                                                    class="num" <% } %>>
                                                    < </a> 
                                            </li>
                                            <% for(var i = 0; i < results.length / page_num; i++){  %>
                                            <li class="paging_on"><a href="/admin/m_certiContent/certicontentAll?certiDivision=<%= param %>&page=<%= i + 1 %>"
                                                    <%if(page==i+1){%>class="selected"
                                                    <%}%> class="num"><%= i + 1 %></a> 
                                            </li> 
                                            <% } %>
                                            <li><a <%if(page>last-1){%><%} else {%>
                                                    href="/admin/m_certiContent/certicontentAll?certiDivision=<%= param %>&page=<%= parseInt(page) + 1 %>"
                                                    class="num" <% } %>>></a>
                                            </li>
                                            <li><a href="/admin/m_certiContent/certicontentAll?certiDivision=<%= param %>&page=<%= last%>"
                                                    class="num">>></a></li>
                                        </ul>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<script>
    //상세보기
    function selectOne(certiContentId) {
        $("input[name='certiContentId']").val(certiContentId);
        $("form[name='certiContForm']").attr("method", "get");
        $("form[name='certiContForm']").attr("action", "one");
        $("form[name='certiContForm']").submit();
    }

    //탄소실천, 챌린지 글 등록
    function enroll() {
        $("form[name='certiContForm']").attr("method", "get");
        $("form[name='certiContForm']").attr("action", "certiWritForm");
        $("form[name='certiContForm']").submit();
    }

    //댓글
    function comment(theURL, winName, features, certiContentId, certiDivision) {
        theURL += '?certiContentId=' + certiContentId + '&certiDivision=' + certiDivision;
        window.open(theURL, winName, features);
    }
</script>