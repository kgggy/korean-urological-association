<main class="main">
    <!-- Breadcrumb-->
    <ol class="breadcrumb">
        <li class="breadcrumb-item">Home</li>
        <li class="breadcrumb-item">
            <a style="font-weight: bold;">탄소 실천 관리</a>
        </li>
        <li class="breadcrumb-item active">탄소 실천 종류 상세</li>
        <!-- Breadcrumb Menu-->
    </ol>
    <div class="container-fluid">
        <div class="animated fadeIn">
            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <% if(result.length > 0) { %>
                        <%if(result[0].certiDivision == 0){%>
                        <div class="card-header">
                            <i class="fa fa-align-justify"></i> 탄소실천 종류 수정</div>
                        <% } else {%>
                        <div class="card-header">
                            <i class="fa fa-align-justify"></i> 챌린지 종류 수정</div>
                        <% } %>
                        <div class="card-body">
                            <!-- 컨텐츠 -->
                            <form action="" id="certiUpdate" name="certiUpdate" method="" enctype="multipart/form-data">
                                <input type="hidden" id="certiSubDivision" name="certiSubDivision" value="">
                                <input type="hidden" id="certiTitleId" name="certiTitleId"
                                    value="<%=result[0].certiTitleId%>">
                                <input type="hidden" id="certiAuth" name="certiAuth" value="">
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">번호</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="ucmtitle" type="text" name="ucmtitle"
                                            disabled="disabled" value="<%=result[0].certiTitleId%>" readonly>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">대표 이미지</label>
                                    <div class="col-md-9">
                                        <% if(result.length > 0 && result[0].certiImage != null && result[0].certiImage != '') {%>
                                        <img src="../../../<%= result[0].certiImage %>" alt="사진" width="40%" />
                                        <button id="searchAction" class="btn btn-block btn-outline-danger fileDelete" type="button"
                                            onclick="javascript:file_del();">삭제</button>
                                        <input type="hidden" id="certiImage" name="certiImage"
                                            value="<%=result[0].certiImage%>">
                                        </td>
                                        <% }else{ %>
                                        <input type="file" id="file" name="file" />
                                        <% } %>
                                    </div>
                                </div>
                                <% if(result[0].certiDivision == 0) {%>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">분류</label>
                                    <div class="col-md-9">
                                        <select id="division" name="division" class="dropdown">
                                            <option value="" selected="selected">--분류--</option>
                                            <% for(var i = 0; i < div.length ; i++){  %>
                                            <option value="<%= div[i].certiSubDivision %>"
                                                <%if(result[0].certiSubDivision==div[i].certiSubDivision){%> selected="selected"
                                                <%}%>><%= div[i].certiSubDivision %></option> <% } %> </select>
                                    </div>
                                </div>
                                <% } %>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">종류명</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="certiTitle" type="text" name="certiTitle"
                                            value="<%=result[0].certiTitle%>">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">설명글</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="certiDetail" type="text" name="certiDetail"
                                            value="<%=result[0].certiDetail%>">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">포인트</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="certiPoint" type="text" name="certiPoint"
                                            value="<%=result[0].certiPoint%>">
                                    </div>
                                </div>
                                <% if(result[0].certiDivision == 0) {%>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">단계</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="certiDiff" type="text" name="certiDiff"
                                            value="<%=result[0].certiDiff%>">
                                    </div>
                                </div>
                                <% }else{ %>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">권한</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="certiAuth" type="text" name="certiAuth"
                                            value="<%=result[0].certiAuth%>">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">기간</label>
                                    <div class="col-md-9">
                                        <input class="form-control" id="certiStartDate" type="date"
                                            name="certiStartDate" value="<%=result[0].certiStartDatefmt%>">
                                        <input class="form-control" id="certiEndDate" type="date" name="certiEndDate"
                                            value="<%=result[0].certiEndDatefmt%>">
                                    </div>
                                </div>
                                <% } %>
                                <div class="form-group row">
                                    <label class="col-md-2 col-form-label" for="text-input">노출여부</label>
                                    <div class="col-md-9">
                                        <select class="dropdown" name="certiShow">
                                            <option value="0" <%if(result[0].certiShow=="0"){%> selected="selected" <%}%> >노출</option>
                                            <option value="1" <%if(result[0].certiShow=="1"){%> selected="selected"
                                                <%}%> >비노출</option>
                                         </select>
                                    </div>
                                </div>
                                <!--option 버튼  -->
                                <div class="option_button">
                                    <div>
                                        <button class="btn btn-block btn-outline-success" type="button" id="update_btn" onclick="certiUpdate(); return false;">수정</button>
                                    </div>
                                    <div>
                                        <button class="btn btn-block btn-outline-danger" type="button"
                                           onclick="location.href='/admin/m_certification/selectOne?certiTitleId=<%=result[0].certiTitleId%>'">취소</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    const formObj = $("form[name='certiUpdate']");
    //수정
    $("#update_btn").on("click", function () {
        if ($("#division option:selected").val() == '') {
            alert("분류를 선택해주세요.");
            return false;
        }
        if ($("input[name=certiTitle]").val() == '') {
            alert("종류명을 입력해주세요.");
            return false;
        }
        if ($("input[name=certiDetail]").val() == '') {
            alert("설명글을 입력해주세요.");
            return false;
        }
        if ($("input[name=certiDiff]").val() == '') {
            alert("단계를 입력해주세요.");
            return false;
        }
        if (confirm("수정하시겠습니까?") == true) {
            const content = $("#content").val();
            $('input[name=certiSubDivision]').val($("#division option:selected").val());
            $('input[name=certiAuth]').val($("#chooseAuth option:selected").text());
            $("#certiDetail").attr("value", content);
            formObj.attr("action", "certiUpdate");
            formObj.attr("method", "post");
            formObj.submit();
            alert("수정이 완료되었습니다.");
        } else {
            return;
        }
    });

    //첨부파일 삭제
    function file_del() {
        if (confirm("실제 파일이 삭제됩니다 \n정말 삭제하시겠습니까?")) {
            formObj.attr("action", "certiImgDelete");
            formObj.attr("method", "get");
            formObj.submit();
        }
    }
</script>