<style>
	.subTitle {
		display: inline-block;
		text-align: left;
		width: 500px !important;
		height: 34px !important;
		position: relative;
		width: 160px;
		border: 1px solid #ccc;
		cursor: pointer;
		background: #fff;
		border-radius: 3px;
		-webkit-user-select: none;
		-moz-user-select: none;
		user-select: none;
	}

	.sub div:first-child {
		display: inline-block;
		text-align: left;
		padding-right: 50px;
		width: auto !important;
		height: 34px !important;
	}

	.subTitle option {
		font-size: 13px !important;
		padding: 10px 12px !important;
	}

	.subTitle option.hover {
		background-color: orange;
	}
</style>
<main class="main">
	<!-- Breadcrumb-->
	<ol class="breadcrumb">
		<li class="breadcrumb-item">Home</li>
		<li class="breadcrumb-item">
			<a style="font-weight: bold;">배너관리</a>
		</li>
		<li class="breadcrumb-item active">팝업배너</li>
	</ol>

	<div class="container-fluid">
		<div class="animated fadeIn">
			<div class="row">
				<div class="col-lg-6">
					<div class="card">
						<div class="card-header">
							<i class="fa fa-align-justify"></i> 배너 수정
						</div>
						<div class="card-body">
							<!-- 컨텐츠 -->
							<form action="" id="bannerUdt" name="bannerUdt" method="" enctype="multipart/form-data">
								<input type="hidden" name="bannerId" value="<%=result[0].bannerId%>">
								<input type="hidden" name="bannerRoute" value="<%=result[0].bannerRoute%>">
								<input type="hidden" name="bannerDiv" value="0">
								<input type="hidden" name="showYN" value="">
								<div class="form-group row">
									<label class="col-md-2 col-form-label">이미지</label>
									<% if(result.length > 0 && result[0].bannerRoute != null && result[0].bannerRoute != '') { %>
									<div style="display: flex; flex-direction: column; gap: 25px; padding-left: 15px">
										<img src="../../../<%=result[0].bannerRoute%>" width="100%">&nbsp;
										<button class="btn btn-block btn-outline-danger" name="fileDelete"
											data-bannerRoute="<%=result[0].bannerRoute%>">삭제</button>
									</div>
									<% } else {%>
									<div class="col-md-9 sub"><input type="file" id="file" name="file" /></div>
									<% } %>
									</td>
								</div>
								<div class="form-group row">
									<label class="col-md-2 col-form-label" for="text-input">시작 날짜</label>
									<div class="col-md-9 sub">
										<input type="date" id="startDate" name="startDate"
											value="<%=result[0].startDatefmt%>">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-md-2 col-form-label" for="text-input">종료 날짜</label>
									<div class="col-md-9 sub">
										<input type="date" id="endDate" name="endDate"
											value="<%=result[0].endDatefmt%>">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-md-2 col-form-label" for="text-input">순서</label>
									<div class="col-md-9 sub">
										<input type="number" id="showNo" name="showNo" value="<%=result[0].showNo%>">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-md-2 col-form-label" for="text-input">노출 여부</label>
									<div class="col-md-9 sub">
										<select class="dropdown" id="showYN">
											<option value='0' <%if(result[0].showYN=="0"){%> selected="selected" <%}%>>노출</option>
											<option value="1" <%if(result[0].showYN=="1"){%> selected="selected" <%}%>>비노출</option>
										</select>
									</div>
								</div>
								<!--option 버튼  -->
								<div class="option_button" style="padding-left: 1.25rem; margin-bottom: 15px;">
									<div>
										<button class="btn btn-block btn-outline-success" type="button"
											id="enroll_btn" onclick="bannerUpdate()">수정</button>
									</div>
									<div>
										<button class="btn btn-block btn-outline-danger" type="button"
											onclick="history.go(-1)">취소</button>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</main>

<script type="text/javascript">
	var formObj = $("form[name='bannerUdt']");
	$(document).ready(function () {
		//확장자 체크
		$("input:file[name='file']").change(function () {
			var str = $(this).val();
			var fileName = str.split('\\').pop().toLowerCase();
			// alert(fileName);
			checkFileName(fileName);
		});
	});

	//확장자 체크
	function checkFileName(str) {
		var ext = str.split('.').pop().toLowerCase();
		// alert(ext);
		if ($.inArray(ext, ['jpg', 'png', 'jpeg', 'gif']) == -1) {
			alert(ext + '파일은 업로드 하실 수 없습니다.');
			$("input:file[name='file']").val("");
		}
	}

	function bannerUpdate() {
		if (confirm("수정하시겠습니까?") == true) {
			$('input[name=showYN]').val($("#showYN option:selected").val());
			formObj.attr("action", "bannerUpdate");
			formObj.attr("method", "post");
			formObj.submit();
			alert("수정이 완료되었습니다.");
		} else {
			return;
		}
	};
	
	// 첨부파일 삭제
	$("[name=fileDelete]").on("click", function () {
		$('input[name=bannerRoute').val($(this).attr('data-bannerRoute'));
		if (confirm("실제 파일이 삭제됩니다. 정말 삭제하시겠습니까?") == true) {
			formObj.attr("action", "bannerImgDelete");
			formObj.attr("method", "get");
			formObj.submit();
			alert("삭제되었습니다.");
		} else {
			return;
		}
	});
</script>